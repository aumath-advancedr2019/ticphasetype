<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ticphasetype • ticphasetype</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="ticphasetype">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ticphasetype</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/ticphasetype.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/aumath-advancedr2019/ticphasetype">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>ticphasetype</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/aumath-advancedr2019/ticphasetype/blob/master/vignettes/ticphasetype.Rmd"><code>vignettes/ticphasetype.Rmd</code></a></small>
      <div class="hidden name"><code>ticphasetype.Rmd</code></div>

    </div>

    
    
<div id="introduction-to-the-package" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction-to-the-package" class="anchor"></a>Introduction to the package</h1>
<p><code>ticphasetype</code> is useful for representing classical statistics in population genetics by means of phase-type theory. This provides additional flexibility and efficiency for computing and understanding these statistics at the finest level. Do not hesitate to run <code><a href="../reference/ticphasetype-package.html">?ticphasetype</a></code> for a quick summary of the available functions, or to open the help files for the individual functions. There is also a brief description of both continuous and discrete phase-type distributions.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(ticphasetype)</a></code></pre></div>
</div>
<div id="continuous-phase-type-distributions-t_mrca-and-t_total" class="section level1">
<h1 class="hasAnchor">
<a href="#continuous-phase-type-distributions-t_mrca-and-t_total" class="anchor"></a>Continuous phase-type distributions: <span class="math inline">\(T_{MRCA}\)</span> and <span class="math inline">\(T_{Total}\)</span>
</h1>
<div id="theoretical-background" class="section level2">
<h2 class="hasAnchor">
<a href="#theoretical-background" class="anchor"></a>Theoretical background</h2>
<p>In an evolutionary tree the time until two sequences coalesce <span class="math inline">\(T_i\)</span> can be measured in number of generations <span class="math inline">\(R_i\)</span> divided by the population size <span class="math inline">\(N\)</span>, this is, <span class="math inline">\(T_i=R_i/N\)</span>. <span class="math inline">\(T_i\)</span> can easily be proven to approximate to an exponential distribution with rate <span class="math inline">\(\binom{i}{2}\)</span>.</p>
<p>In order to understand the evolutionary history of sequences two additional quantities can be defined –namely the time until the most recent common ancestor <span class="math inline">\(T_{MRCA}\)</span> and the total tree length <span class="math inline">\(T_{Total}\)</span>. <span class="math inline">\(T_{MRCA}\)</span> will simply be the sum of all times until two sequences coalesce, in other words <span class="math inline">\(T_{MRCA}=T_n+T_{n-1}+...+T_2\)</span>, where <span class="math inline">\(T_i\sim\text{exp}(\binom{i}{2})\)</span>. <span class="math inline">\(T_{Total}\)</span>, on the other hand, takes into account the length of all possible branches, so <span class="math inline">\(T_{Total}=nT_n+(n-1)T_{n-1}+...+2T_2\)</span> and, thus, <span class="math inline">\(iT_i\sim \text{exp}(\binom{i-1}{2})\)</span>.</p>
<p>The mean and variance of these two quantities can be derived relatively easily. Defining their distribution, however, has proven to be more challenging since both <span class="math inline">\(T_{MRCA}\)</span> and <span class="math inline">\(T_{Total}\)</span> are sums of independent exponentially distributed variables with different rates. Their distribution can be computed as a series of convolutions, but their formulation, application and interpretation might be challenging for the average population geneticist.</p>
<p>Instead, we can think of the sum of exponential distributions as a continuous-time Markov chain, where coalescent events are represented as Markov jumps with rate <span class="math inline">\(T_i\)</span> for <span class="math inline">\(T_{MRCA}\)</span> and <span class="math inline">\(iT_i\)</span> for <span class="math inline">\(T_{Total}\)</span>. The Markov chain will end with an absorbing state, which in both cases will be the MRCA.</p>
<p>The Markov chain can be represented using phase-type theory, where the jump rates are defined with a sub-intensity matrix <span class="math inline">\(T\)</span> and the initial distribution will be defined as a row vector <span class="math inline">\(\pi\)</span>. If we define <span class="math inline">\(\tau\)</span> as the smallest time (or length) to reach the absorbing state, then <span class="math inline">\(\tau\sim PH(\pi,T)\)</span>. This continuous phase-type distribution has well-documented and easy-to-implement formulas for the expectation, the variance, the survival function, the distribution function and the density function. Moreover, since both <span class="math inline">\(\pi\)</span> and <span class="math inline">\(T\)</span> can easily be speficied, we can represent evolutionary histories that do not follow the standard coalescent model and still use the same phase-type formulas.</p>
<p><code>ticphasetype</code> contains an efficient implementation of continuous phase-type distributions. It has a user-friendly interface for creating phase-type representations of <span class="math inline">\(T_{MRCA}\)</span> and <span class="math inline">\(T_{Total}\)</span> under the standard coalescent model, but it also allows the user to specify their own sub-intensity matrix and initial probabilities for a more flexible implementation.</p>
</div>
<div id="time-until-the-most-recent-common-ancestor-t_mrca" class="section level2">
<h2 class="hasAnchor">
<a href="#time-until-the-most-recent-common-ancestor-t_mrca" class="anchor"></a>Time until the most recent common ancestor (<span class="math inline">\(T_{MRCA}\)</span>)</h2>
<p>A <code>cont_phase_type</code> class representing a continuous phase-type distribution for <span class="math inline">\(T_{MRCA}\)</span> can be generated using <code><a href="../reference/cont_phase_type.html">cont_phase_type()</a></code>. For example, when <code>n</code>=5:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">T_MRCA_ph &lt;-<span class="st"> </span><span class="kw"><a href="../reference/t_mrca.html">t_mrca</a></span>(<span class="dt">n =</span> <span class="dv">5</span>)</a></code></pre></div>
<p>There are a number of methods associated with the <code>cont_phase_type</code>, such as:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(T_MRCA_ph)</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="co">#&gt; [1] 1.6</span></a></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw"><a href="../reference/var.html">var</a></span>(T_MRCA_ph)</a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="co">#&gt; [1] 1.148889</span></a></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(T_MRCA_ph)</a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="co">#&gt; Subintensity matrix:</span></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="co">#&gt;      [,1] [,2] [,3] [,4]</span></a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="co">#&gt; [1,]  -10   10    0    0</span></a>
<a class="sourceLine" id="cb5-6" data-line-number="6"><span class="co">#&gt; [2,]    0   -6    6    0</span></a>
<a class="sourceLine" id="cb5-7" data-line-number="7"><span class="co">#&gt; [3,]    0    0   -3    3</span></a>
<a class="sourceLine" id="cb5-8" data-line-number="8"><span class="co">#&gt; [4,]    0    0    0   -1</span></a>
<a class="sourceLine" id="cb5-9" data-line-number="9"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-10" data-line-number="10"><span class="co">#&gt; Initial probabilities:</span></a>
<a class="sourceLine" id="cb5-11" data-line-number="11"><span class="co">#&gt;      [,1] [,2] [,3] [,4]</span></a>
<a class="sourceLine" id="cb5-12" data-line-number="12"><span class="co">#&gt; [1,]    1    0    0    0</span></a>
<a class="sourceLine" id="cb5-13" data-line-number="13"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-14" data-line-number="14"><span class="co">#&gt; Defect:</span></a>
<a class="sourceLine" id="cb5-15" data-line-number="15"><span class="co">#&gt; [1] 0</span></a>
<a class="sourceLine" id="cb5-16" data-line-number="16"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-17" data-line-number="17"><span class="co">#&gt; Mean: 1.6</span></a>
<a class="sourceLine" id="cb5-18" data-line-number="18"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-19" data-line-number="19"><span class="co">#&gt; Variance: 1.148889</span></a></code></pre></div>
</div>
<div id="total-tree-lenght-t_total" class="section level2">
<h2 class="hasAnchor">
<a href="#total-tree-lenght-t_total" class="anchor"></a>Total tree lenght (<span class="math inline">\(T_{Total}\)</span>)</h2>
<p><span class="math inline">\(T_{Total}\)</span> can also be represented using the <code>cont_phase_type</code> class:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">T_Total_ph &lt;-<span class="st"> </span><span class="kw"><a href="../reference/t_total.html">t_total</a></span>(<span class="dt">n =</span> <span class="dv">5</span>)</a></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(T_Total_ph)</a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="co">#&gt; Subintensity matrix:</span></a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="co">#&gt;      [,1] [,2] [,3] [,4]</span></a>
<a class="sourceLine" id="cb7-5" data-line-number="5"><span class="co">#&gt; [1,]   -2  2.0  0.0  0.0</span></a>
<a class="sourceLine" id="cb7-6" data-line-number="6"><span class="co">#&gt; [2,]    0 -1.5  1.5  0.0</span></a>
<a class="sourceLine" id="cb7-7" data-line-number="7"><span class="co">#&gt; [3,]    0  0.0 -1.0  1.0</span></a>
<a class="sourceLine" id="cb7-8" data-line-number="8"><span class="co">#&gt; [4,]    0  0.0  0.0 -0.5</span></a>
<a class="sourceLine" id="cb7-9" data-line-number="9"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-10" data-line-number="10"><span class="co">#&gt; Initial probabilities:</span></a>
<a class="sourceLine" id="cb7-11" data-line-number="11"><span class="co">#&gt;      [,1] [,2] [,3] [,4]</span></a>
<a class="sourceLine" id="cb7-12" data-line-number="12"><span class="co">#&gt; [1,]    1    0    0    0</span></a>
<a class="sourceLine" id="cb7-13" data-line-number="13"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-14" data-line-number="14"><span class="co">#&gt; Defect:</span></a>
<a class="sourceLine" id="cb7-15" data-line-number="15"><span class="co">#&gt; [1] 0</span></a>
<a class="sourceLine" id="cb7-16" data-line-number="16"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-17" data-line-number="17"><span class="co">#&gt; Mean: 4.166667</span></a>
<a class="sourceLine" id="cb7-18" data-line-number="18"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-19" data-line-number="19"><span class="co">#&gt; Variance: 5.694444</span></a></code></pre></div>
</div>
<div id="user-defined-sub-intensity-matrix" class="section level2">
<h2 class="hasAnchor">
<a href="#user-defined-sub-intensity-matrix" class="anchor"></a>User-defined sub-intensity matrix</h2>
<p>Moreover, the height of an evolutionary tree can also be represented by a user-defined sub-intensity matrix. This is specially useful if the model does not follow Kingman’s n–coalescent, but other coalescent models such as the psi-coalescent or the beta-coalescent. As an example, an arbitrary sub-intensity matrix can be generated:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">n=<span class="dv">5</span></a>
<a class="sourceLine" id="cb8-2" data-line-number="2">subint_arbit &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="dv">0</span>, <span class="dt">nrow =</span> n<span class="dv">-1</span>, <span class="dt">ncol =</span> n<span class="dv">-1</span>)</a>
<a class="sourceLine" id="cb8-3" data-line-number="3"></a>
<a class="sourceLine" id="cb8-4" data-line-number="4"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>(n<span class="dv">-1</span>)) {</a>
<a class="sourceLine" id="cb8-5" data-line-number="5">  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>(n<span class="dv">-1</span>)) {</a>
<a class="sourceLine" id="cb8-6" data-line-number="6">    <span class="cf">if</span> (j<span class="op">&gt;</span>i) {</a>
<a class="sourceLine" id="cb8-7" data-line-number="7">      subint_arbit[i,j] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb8-8" data-line-number="8">    }</a>
<a class="sourceLine" id="cb8-9" data-line-number="9">  }</a>
<a class="sourceLine" id="cb8-10" data-line-number="10">  subint_arbit[i,i] &lt;-<span class="st"> </span><span class="op">-</span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(subint_arbit[i,])</a>
<a class="sourceLine" id="cb8-11" data-line-number="11">}</a>
<a class="sourceLine" id="cb8-12" data-line-number="12"></a>
<a class="sourceLine" id="cb8-13" data-line-number="13">subint_arbit[n<span class="dv">-1</span>,n<span class="dv">-1</span>] &lt;-<span class="st"> </span><span class="dv">-1</span></a></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">subint_arbit</a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="co">#&gt;           [,1]       [,2]      [,3]      [,4]</span></a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="co">#&gt; [1,] -16.77763   6.516313  7.696890  2.564430</span></a>
<a class="sourceLine" id="cb9-4" data-line-number="4"><span class="co">#&gt; [2,]   0.00000 -11.832978  6.306856  5.526122</span></a>
<a class="sourceLine" id="cb9-5" data-line-number="5"><span class="co">#&gt; [3,]   0.00000   0.000000 -5.070151  5.070151</span></a>
<a class="sourceLine" id="cb9-6" data-line-number="6"><span class="co">#&gt; [4,]   0.00000   0.000000  0.000000 -1.000000</span></a></code></pre></div>
<p>This matrix can be supplied to the <code><a href="../reference/cont_phase_type.html">cont_phase_type()</a></code> generator function, together with optional initial probabilities:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">T_arbit_ph &lt;-<span class="st"> </span><span class="kw"><a href="../reference/cont_phase_type.html">cont_phase_type</a></span>(<span class="dt">subint_mat =</span> subint_arbit)</a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="co">#&gt; Warning in cont_phase_type(subint_mat = subint_arbit): The initial</span></a>
<a class="sourceLine" id="cb10-3" data-line-number="3"><span class="co">#&gt; probability vector is automatically generated.</span></a></code></pre></div>
<p>If the initial probabilities are not supplied (as is the case above), then <code><a href="../reference/cont_phase_type.html">cont_phase_type()</a></code> automatically generates a vector of initial probabilities as <span class="math inline">\(\pi=(1,0,...,0)\)</span> and raises a warning message.</p>
<p>We can apply the methods <code>cont_phase_type</code> class methods for this new user-tailored phase-type distribution:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(T_arbit_ph)</a>
<a class="sourceLine" id="cb11-2" data-line-number="2"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb11-3" data-line-number="3"><span class="co">#&gt; Subintensity matrix:</span></a>
<a class="sourceLine" id="cb11-4" data-line-number="4"><span class="co">#&gt;           [,1]       [,2]      [,3]      [,4]</span></a>
<a class="sourceLine" id="cb11-5" data-line-number="5"><span class="co">#&gt; [1,] -16.77763   6.516313  7.696890  2.564430</span></a>
<a class="sourceLine" id="cb11-6" data-line-number="6"><span class="co">#&gt; [2,]   0.00000 -11.832978  6.306856  5.526122</span></a>
<a class="sourceLine" id="cb11-7" data-line-number="7"><span class="co">#&gt; [3,]   0.00000   0.000000 -5.070151  5.070151</span></a>
<a class="sourceLine" id="cb11-8" data-line-number="8"><span class="co">#&gt; [4,]   0.00000   0.000000  0.000000 -1.000000</span></a>
<a class="sourceLine" id="cb11-9" data-line-number="9"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb11-10" data-line-number="10"><span class="co">#&gt; Initial probabilities:</span></a>
<a class="sourceLine" id="cb11-11" data-line-number="11"><span class="co">#&gt;      [,1] [,2] [,3] [,4]</span></a>
<a class="sourceLine" id="cb11-12" data-line-number="12"><span class="co">#&gt; [1,]    1    0    0    0</span></a>
<a class="sourceLine" id="cb11-13" data-line-number="13"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb11-14" data-line-number="14"><span class="co">#&gt; Defect:</span></a>
<a class="sourceLine" id="cb11-15" data-line-number="15"><span class="co">#&gt; [1] 0</span></a>
<a class="sourceLine" id="cb11-16" data-line-number="16"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb11-17" data-line-number="17"><span class="co">#&gt; Mean: 1.223737</span></a>
<a class="sourceLine" id="cb11-18" data-line-number="18"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb11-19" data-line-number="19"><span class="co">#&gt; Variance: 1.040859</span></a></code></pre></div>
</div>
<div id="density-distribution-and-quantile-functions" class="section level2">
<h2 class="hasAnchor">
<a href="#density-distribution-and-quantile-functions" class="anchor"></a>Density, distribution and quantile functions</h2>
<p><code>ticphasetype</code> also includes the density function (<code><a href="../reference/dphtype.html">dphtype()</a></code>), quantile function (<code><a href="../reference/dphtype.html">qphtype()</a></code>), distribution function (<code><a href="../reference/dphtype.html">pphtype()</a></code>) and random draw generator (<code><a href="../reference/dphtype.html">rphtype()</a></code>) for the continuous phase-type distribution:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="kw"><a href="../reference/dphtype.html">dphtype</a></span>(<span class="fl">0.5</span>, T_MRCA_ph)</a>
<a class="sourceLine" id="cb12-2" data-line-number="2"><span class="co">#&gt; [1] 0.4013376</span></a></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">x &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb13-2" data-line-number="2">y &lt;-<span class="st"> </span><span class="kw"><a href="../reference/dphtype.html">dphtype</a></span>(x, T_MRCA_ph)</a>
<a class="sourceLine" id="cb13-3" data-line-number="3"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(x, y, <span class="dt">type =</span> <span class="st">'l'</span>)</a>
<a class="sourceLine" id="cb13-4" data-line-number="4"><span class="kw"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span>(x, y)</a>
<a class="sourceLine" id="cb13-5" data-line-number="5"><span class="kw"><a href="https://rdrr.io/r/graphics/title.html">title</a></span>(<span class="st">'Density function of T_MRCA'</span>)</a></code></pre></div>
<p><img src="ticphasetype_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="kw"><a href="../reference/dphtype.html">qphtype</a></span>(<span class="fl">0.5</span>, T_MRCA_ph)</a>
<a class="sourceLine" id="cb14-2" data-line-number="2"><span class="co">#&gt; [1] 1.335997</span></a></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1">x &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">0</span>,<span class="fl">0.99</span>,<span class="fl">0.01</span>)</a>
<a class="sourceLine" id="cb15-2" data-line-number="2">y &lt;-<span class="st"> </span><span class="kw"><a href="../reference/dphtype.html">qphtype</a></span>(x, T_MRCA_ph)</a>
<a class="sourceLine" id="cb15-3" data-line-number="3"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(x, y, <span class="dt">type =</span> <span class="st">'l'</span>)</a>
<a class="sourceLine" id="cb15-4" data-line-number="4"><span class="kw"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span>(x, y)</a>
<a class="sourceLine" id="cb15-5" data-line-number="5"><span class="kw"><a href="https://rdrr.io/r/graphics/title.html">title</a></span>(<span class="st">'Quantile function of T_MRCA'</span>)</a></code></pre></div>
<p><img src="ticphasetype_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="kw"><a href="../reference/dphtype.html">pphtype</a></span>(<span class="fl">0.5</span>, T_MRCA_ph)</a>
<a class="sourceLine" id="cb16-2" data-line-number="2"><span class="co">#&gt; [1] 0.0812838</span></a></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1">x &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">0</span>,<span class="dv">6</span>,<span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb17-2" data-line-number="2">y &lt;-<span class="st"> </span><span class="kw"><a href="../reference/dphtype.html">pphtype</a></span>(x, T_MRCA_ph)</a>
<a class="sourceLine" id="cb17-3" data-line-number="3"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(x, y, <span class="dt">type =</span> <span class="st">'l'</span>)</a>
<a class="sourceLine" id="cb17-4" data-line-number="4"><span class="kw"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span>(x, y)</a>
<a class="sourceLine" id="cb17-5" data-line-number="5"><span class="kw"><a href="https://rdrr.io/r/graphics/title.html">title</a></span>(<span class="st">'Distribution function of T_MRCA'</span>)</a></code></pre></div>
<p><img src="ticphasetype_files/figure-html/unnamed-chunk-17-1.png" width="700"></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1"><span class="kw"><a href="../reference/dphtype.html">rphtype</a></span>(<span class="dv">3</span>, T_MRCA_ph)</a>
<a class="sourceLine" id="cb18-2" data-line-number="2"><span class="co">#&gt; [1] 1.175846 1.442736 0.644917</span></a></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1">x &lt;-<span class="st"> </span><span class="kw"><a href="../reference/dphtype.html">rphtype</a></span>(<span class="dv">10000</span>, T_MRCA_ph)</a>
<a class="sourceLine" id="cb19-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span>(x, <span class="dt">main =</span> <span class="st">'Random draws of T_MRCA'</span>, <span class="dt">breaks=</span><span class="dv">20</span>)</a></code></pre></div>
<p><img src="ticphasetype_files/figure-html/unnamed-chunk-19-1.png" width="700"></p>
</div>
</div>
<div id="discrete-phase-type-distributions-s_total-xi_i-and-xi_k" class="section level1">
<h1 class="hasAnchor">
<a href="#discrete-phase-type-distributions-s_total-xi_i-and-xi_k" class="anchor"></a>Discrete Phase-Type Distributions: <span class="math inline">\(S_{total}\)</span>, <span class="math inline">\(\xi_i\)</span> and <span class="math inline">\(\xi_{k+}\)</span>
</h1>
<div id="theoretical-background-1" class="section level2">
<h2 class="hasAnchor">
<a href="#theoretical-background-1" class="anchor"></a>Theoretical background</h2>
<p>Some quantities in population genomics are discrete, such as the total number of segregating sites <span class="math inline">\(S_{total}\)</span> or other statistics related to the site-frequency spectrum (singletons, doubletons, tail statistic, etc.). Representing the site-frequency spectrum, or SFS, can be challenging if the sample size is large, if the data does not follow Kingman’s coalescence or if we are trying to estimate the mutation parameter <span class="math inline">\(\theta\)</span> using non-standard estimators.</p>
<p>Luckily, all these quantities can be represented using discrete phase-type theory. Similar to the continuous phase-type distribution being a generalization of exponentially distributed variables, the discrete phase-type distribution can be seen as a generalization of various geometric distributions. Each state in the continuous phase-type distribution will represent a stochastic process, such that the time until absorption of a random variable (<span class="math inline">\(\tau\)</span>) follows an absorbing Markov chain. In this case we say that <span class="math inline">\(\tau+1\sim DPH(\pi, T)\)</span>, where <span class="math inline">\(T\)</span> is the sub-intensity matrix that gathers the transition rates and <span class="math inline">\(\pi\)</span> is the vector of initial probabilities.</p>
<p>The discrete phase-type representation of <span class="math inline">\(S_{total}\)</span> can be built from the continuous phase-type representation of the total branch length. Folllowing theorem 3.5 in Hobolth et. al (2019), the total branch length can be discretized if the mutation parameter <span class="math inline">\(\theta\)</span> is supplied.</p>
<p>On the other hand, singletons, doubletons and related variables (referred to as i-tons or <span class="math inline">\(\xi_i\)</span> throughout this vignette), require a more elaborate formulation. The idea behind consists in first building a continuous phase-type representation of the coalescent process, where the sub-intensity matrix will contain the rates of transition between all the possible branch types of all possible genealogies. Among all these branches, only a certain number will give rise to i-tons. We can calculate which branches these are, together with the weights associated to each of them. Using this information, we can reward-transform the continuous phase-type representation of the coalescent process, so it only represents those branches that give rise to a certain i-ton. Afterwards, we can discretize this representation using theorem 3.5 in Hobolth et. al (2019) and the mutation parameter <span class="math inline">\(\theta\)</span>.</p>
<p>Bear in mind that it is possible for some i-tons to never be observed. This means that the initial probability vector might not sum up to 1, because the variable might directly jump to the absorbing state. The probability that this happens is the so-called defect.</p>
<p>Because we have calculated the rewards for each of the i-tons, we can easily compute the reward for the sum of various i-tons. As an example, we can calculate a phase-type representation of the tail statistic, which is defined as <span class="math inline">\(S_{k+} = \sum_{i = k}^{n-1} \xi_i\)</span>, by reward-transforming the phase-type representation of the coalescent by the sum of the rewards of individual i-tons. This tail statistic, together with normalized singletons, is useful to distinguish between the traditional Kingsman coalescent and a multiple merger coalescent (Koskela (2018)).</p>
<p>Note that <span class="math inline">\(S_{total}\)</span> can also be represented by reward-transforming the coalescent process with the sum of the rewards for all the i-tons. However, this representation of <span class="math inline">\(S_{total}\)</span> is more inefficient, so the one explained above is used in the package.</p>
<p>Because phase-type theory has well-defined functions for discrete phase-type distributions, the expectation, the variance, the survival function, the distribution function and the density function of all the variables defined above can be computed efficiently. <code>ticphasetype</code> contains an efficient implementation of continuous phase-type distribution, together with wrapper functions for representing i-tons, tail statistics and the number of segregating sites.</p>
</div>
<div id="total-number-of-segregating-sites-s_total" class="section level2">
<h2 class="hasAnchor">
<a href="#total-number-of-segregating-sites-s_total" class="anchor"></a>Total number of segregating sites (<span class="math inline">\(S_{total}\)</span>)</h2>
<p>The total number of segregating sites can be represented using a <code>disc_phase_type</code> class, this is, by means of a discrete phase-type distribution. For example, when <code>n</code>=4:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1">stotal_ph =<span class="st"> </span><span class="kw"><a href="../reference/segsites.html">segsites</a></span>(<span class="dv">4</span>, <span class="dt">theta =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb20-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(stotal_ph)</a>
<a class="sourceLine" id="cb20-3" data-line-number="3"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb20-4" data-line-number="4"><span class="co">#&gt; Subintensity matrix:</span></a>
<a class="sourceLine" id="cb20-5" data-line-number="5"><span class="co">#&gt;      [,1] [,2]      [,3]</span></a>
<a class="sourceLine" id="cb20-6" data-line-number="6"><span class="co">#&gt; [1,]  0.4  0.3 0.2000000</span></a>
<a class="sourceLine" id="cb20-7" data-line-number="7"><span class="co">#&gt; [2,]  0.0  0.5 0.3333333</span></a>
<a class="sourceLine" id="cb20-8" data-line-number="8"><span class="co">#&gt; [3,]  0.0  0.0 0.6666667</span></a>
<a class="sourceLine" id="cb20-9" data-line-number="9"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb20-10" data-line-number="10"><span class="co">#&gt; Initial probabilities:</span></a>
<a class="sourceLine" id="cb20-11" data-line-number="11"><span class="co">#&gt;      [,1] [,2] [,3]</span></a>
<a class="sourceLine" id="cb20-12" data-line-number="12"><span class="co">#&gt; [1,]    1    0    0</span></a>
<a class="sourceLine" id="cb20-13" data-line-number="13"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb20-14" data-line-number="14"><span class="co">#&gt; Defect:</span></a>
<a class="sourceLine" id="cb20-15" data-line-number="15"><span class="co">#&gt; [1] 0</span></a>
<a class="sourceLine" id="cb20-16" data-line-number="16"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb20-17" data-line-number="17"><span class="co">#&gt; Mean: 4.666667</span></a>
<a class="sourceLine" id="cb20-18" data-line-number="18"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb20-19" data-line-number="19"><span class="co">#&gt; Variance: 9.111111</span></a></code></pre></div>
<p>The class <code>disc_phase_type</code> is a list containing:</p>
<ul>
<li>reward-transformed matrix (denoted as <code>P</code> in Hobolth (2019)).</li>
<li>vector of initial probabilities (<span class="math inline">\(\pi\)</span>).</li>
<li>defect (probability of not entering any transient state prior to absorption).</li>
</ul>
<p>The variance and the expectation of any discrete phase-type distribution can be computed with <code><a href="../reference/var.html">var()</a></code> and <code><a href="https://rdrr.io/r/base/mean.html">mean()</a></code> respectively:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(stotal_ph)</a>
<a class="sourceLine" id="cb21-2" data-line-number="2"><span class="co">#&gt; [1] 4.666667</span></a>
<a class="sourceLine" id="cb21-3" data-line-number="3"><span class="kw"><a href="../reference/var.html">var</a></span>(stotal_ph)</a>
<a class="sourceLine" id="cb21-4" data-line-number="4"><span class="co">#&gt; [1] 9.111111</span></a></code></pre></div>
</div>
<div id="i-tons-xi_i" class="section level2">
<h2 class="hasAnchor">
<a href="#i-tons-xi_i" class="anchor"></a>i-tons (<span class="math inline">\(\xi_i\)</span>)</h2>
<p>The i-tons <span class="math inline">\(\xi_i\)</span> can also be represented using a discrete phase-type distribution. First, we will define the coalescent process as a continuous phase-type distribution:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1">coalescent &lt;-<span class="st"> </span><span class="kw"><a href="../reference/kingsman.html">kingsman</a></span>(<span class="dv">6</span>)</a></code></pre></div>
<p>The <code><a href="../reference/kingsman.html">kingsman()</a></code> function returns a <code>mult_phase_type</code> object which is a continuous phase-type distribution with a reward matrix <code>RewardM</code>, for later reward-transformation and discretization.</p>
<p>If we want to obtain a representation of the tripletons <span class="math inline">\(\xi_3\)</span> when <code>n</code>=6, we can use the coalescent in the <code><a href="../reference/itons.html">itons()</a></code> function:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1">itons_ph =<span class="st"> </span><span class="kw"><a href="../reference/itons.html">itons</a></span>(coalescent, <span class="dt">i =</span> <span class="dv">3</span>, <span class="dt">theta =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb23-2" data-line-number="2"><span class="co">#&gt; [1] "entered rewardtransformation"</span></a>
<a class="sourceLine" id="cb23-3" data-line-number="3"><span class="co">#&gt;  [1] 1 0 0 0 0 0 0 0 0 0</span></a>
<a class="sourceLine" id="cb23-4" data-line-number="4"><span class="co">#&gt;  [1] 0 0 1 0 0 1 0 0 0 2</span></a>
<a class="sourceLine" id="cb23-5" data-line-number="5"><span class="co">#&gt;       [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10]</span></a>
<a class="sourceLine" id="cb23-6" data-line-number="6"><span class="co">#&gt;  [1,]  -15   15    0    0    0    0    0    0    0     0</span></a>
<a class="sourceLine" id="cb23-7" data-line-number="7"><span class="co">#&gt;  [2,]    0  -10    4    6    0    0    0    0    0     0</span></a>
<a class="sourceLine" id="cb23-8" data-line-number="8"><span class="co">#&gt;  [3,]    0    0   -6    0    3    3    0    0    0     0</span></a>
<a class="sourceLine" id="cb23-9" data-line-number="9"><span class="co">#&gt;  [4,]    0    0    0   -6    1    4    1    0    0     0</span></a>
<a class="sourceLine" id="cb23-10" data-line-number="10"><span class="co">#&gt;  [5,]    0    0    0    0   -3    0    0    2    1     0</span></a>
<a class="sourceLine" id="cb23-11" data-line-number="11"><span class="co">#&gt;  [6,]    0    0    0    0    0   -3    0    1    1     1</span></a>
<a class="sourceLine" id="cb23-12" data-line-number="12"><span class="co">#&gt;  [7,]    0    0    0    0    0    0   -3    0    3     0</span></a>
<a class="sourceLine" id="cb23-13" data-line-number="13"><span class="co">#&gt;  [8,]    0    0    0    0    0    0    0   -1    0     0</span></a>
<a class="sourceLine" id="cb23-14" data-line-number="14"><span class="co">#&gt;  [9,]    0    0    0    0    0    0    0    0   -1     0</span></a>
<a class="sourceLine" id="cb23-15" data-line-number="15"><span class="co">#&gt; [10,]    0    0    0    0    0    0    0    0    0    -1</span></a>
<a class="sourceLine" id="cb23-16" data-line-number="16"><span class="co">#&gt; [1] "64"</span></a>
<a class="sourceLine" id="cb23-17" data-line-number="17"><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5] [,6] [,7]</span></a>
<a class="sourceLine" id="cb23-18" data-line-number="18"><span class="co">#&gt; [1,]    1    0    0    0    0    0    0</span></a>
<a class="sourceLine" id="cb23-19" data-line-number="19"><span class="co">#&gt; [2,]    0    1    0    0    0    0    0</span></a>
<a class="sourceLine" id="cb23-20" data-line-number="20"><span class="co">#&gt; [3,]    0    0    1    0    0    0    0</span></a>
<a class="sourceLine" id="cb23-21" data-line-number="21"><span class="co">#&gt; [4,]    0    0    0    1    0    0    0</span></a>
<a class="sourceLine" id="cb23-22" data-line-number="22"><span class="co">#&gt; [5,]    0    0    0    0    1    0    0</span></a>
<a class="sourceLine" id="cb23-23" data-line-number="23"><span class="co">#&gt; [6,]    0    0    0    0    0    1    0</span></a>
<a class="sourceLine" id="cb23-24" data-line-number="24"><span class="co">#&gt; [7,]    0    0    0    0    0    0    1</span></a>
<a class="sourceLine" id="cb23-25" data-line-number="25"><span class="co">#&gt;      [,1] [,2] [,3]      [,4]      [,5]      [,6]      [,7]</span></a>
<a class="sourceLine" id="cb23-26" data-line-number="26"><span class="co">#&gt; [1,]    0    1  0.0 0.0000000 0.0000000 0.0000000 0.0000000</span></a>
<a class="sourceLine" id="cb23-27" data-line-number="27"><span class="co">#&gt; [2,]    0    0  0.6 0.0000000 0.0000000 0.0000000 0.0000000</span></a>
<a class="sourceLine" id="cb23-28" data-line-number="28"><span class="co">#&gt; [3,]    0    0  0.0 0.1666667 0.1666667 0.0000000 0.0000000</span></a>
<a class="sourceLine" id="cb23-29" data-line-number="29"><span class="co">#&gt; [4,]    0    0  0.0 0.0000000 0.0000000 0.6666667 0.3333333</span></a>
<a class="sourceLine" id="cb23-30" data-line-number="30"><span class="co">#&gt; [5,]    0    0  0.0 0.0000000 0.0000000 0.0000000 1.0000000</span></a>
<a class="sourceLine" id="cb23-31" data-line-number="31"><span class="co">#&gt; [6,]    0    0  0.0 0.0000000 0.0000000 0.0000000 0.0000000</span></a>
<a class="sourceLine" id="cb23-32" data-line-number="32"><span class="co">#&gt; [7,]    0    0  0.0 0.0000000 0.0000000 0.0000000 0.0000000</span></a>
<a class="sourceLine" id="cb23-33" data-line-number="33"><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(itons_ph)</a>
<a class="sourceLine" id="cb23-34" data-line-number="34"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb23-35" data-line-number="35"><span class="co">#&gt; Subintensity matrix:</span></a>
<a class="sourceLine" id="cb23-36" data-line-number="36"><span class="co">#&gt;           [,1]      [,2]       [,3]</span></a>
<a class="sourceLine" id="cb23-37" data-line-number="37"><span class="co">#&gt; [1,] 0.1428571 0.1071429 0.07142857</span></a>
<a class="sourceLine" id="cb23-38" data-line-number="38"><span class="co">#&gt; [2,] 0.0000000 0.2500000 0.16666667</span></a>
<a class="sourceLine" id="cb23-39" data-line-number="39"><span class="co">#&gt; [3,] 0.0000000 0.0000000 0.66666667</span></a>
<a class="sourceLine" id="cb23-40" data-line-number="40"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb23-41" data-line-number="41"><span class="co">#&gt; Initial probabilities:</span></a>
<a class="sourceLine" id="cb23-42" data-line-number="42"><span class="co">#&gt;      [,1] [,2] [,3]</span></a>
<a class="sourceLine" id="cb23-43" data-line-number="43"><span class="co">#&gt; [1,]  0.4  0.4    0</span></a>
<a class="sourceLine" id="cb23-44" data-line-number="44"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb23-45" data-line-number="45"><span class="co">#&gt; Defect:</span></a>
<a class="sourceLine" id="cb23-46" data-line-number="46"><span class="co">#&gt; [1] 0.2</span></a>
<a class="sourceLine" id="cb23-47" data-line-number="47"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb23-48" data-line-number="48"><span class="co">#&gt; Mean: 1.666667</span></a>
<a class="sourceLine" id="cb23-49" data-line-number="49"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb23-50" data-line-number="50"><span class="co">#&gt; Variance: 2.311111</span></a></code></pre></div>
</div>
<div id="tail-statistic-xi_k" class="section level2">
<h2 class="hasAnchor">
<a href="#tail-statistic-xi_k" class="anchor"></a>Tail-statistic (<span class="math inline">\(\xi_{k+}\)</span>)</h2>
<p>In <code>ticphasetype</code> the tail statistic is implemented using the coalescent and the <code><a href="../reference/tailstat.html">tailstat()</a></code> function. For example, <span class="math inline">\(\xi_{3+}\)</span> when <code>n</code>=5:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1">coalescent &lt;-<span class="st"> </span><span class="kw"><a href="../reference/kingsman.html">kingsman</a></span>(<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb24-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw"><a href="../reference/tailstat.html">tailstat</a></span>(coalescent, <span class="dt">k =</span> <span class="dv">3</span>, <span class="dt">theta =</span> <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb24-3" data-line-number="3"><span class="co">#&gt; [1] "entered rewardtransformation"</span></a>
<a class="sourceLine" id="cb24-4" data-line-number="4"><span class="co">#&gt; [1] 1 0 0 0 0 0</span></a>
<a class="sourceLine" id="cb24-5" data-line-number="5"><span class="co">#&gt; [1] 0 0 1 0 1 1</span></a>
<a class="sourceLine" id="cb24-6" data-line-number="6"><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5] [,6]</span></a>
<a class="sourceLine" id="cb24-7" data-line-number="7"><span class="co">#&gt; [1,]  -10   10    0    0    0    0</span></a>
<a class="sourceLine" id="cb24-8" data-line-number="8"><span class="co">#&gt; [2,]    0   -6    3    3    0    0</span></a>
<a class="sourceLine" id="cb24-9" data-line-number="9"><span class="co">#&gt; [3,]    0    0   -3    0    2    1</span></a>
<a class="sourceLine" id="cb24-10" data-line-number="10"><span class="co">#&gt; [4,]    0    0    0   -3    1    2</span></a>
<a class="sourceLine" id="cb24-11" data-line-number="11"><span class="co">#&gt; [5,]    0    0    0    0   -1    0</span></a>
<a class="sourceLine" id="cb24-12" data-line-number="12"><span class="co">#&gt; [6,]    0    0    0    0    0   -1</span></a>
<a class="sourceLine" id="cb24-13" data-line-number="13"><span class="co">#&gt; [1] "64"</span></a>
<a class="sourceLine" id="cb24-14" data-line-number="14"><span class="co">#&gt;      [,1] [,2] [,3]</span></a>
<a class="sourceLine" id="cb24-15" data-line-number="15"><span class="co">#&gt; [1,]    1    0    0</span></a>
<a class="sourceLine" id="cb24-16" data-line-number="16"><span class="co">#&gt; [2,]    0    1    0</span></a>
<a class="sourceLine" id="cb24-17" data-line-number="17"><span class="co">#&gt; [3,]    0    0    1</span></a>
<a class="sourceLine" id="cb24-18" data-line-number="18"><span class="co">#&gt;      [,1] [,2] [,3]</span></a>
<a class="sourceLine" id="cb24-19" data-line-number="19"><span class="co">#&gt; [1,]    0    1  0.0</span></a>
<a class="sourceLine" id="cb24-20" data-line-number="20"><span class="co">#&gt; [2,]    0    0  0.5</span></a>
<a class="sourceLine" id="cb24-21" data-line-number="21"><span class="co">#&gt; [3,]    0    0  0.0</span></a>
<a class="sourceLine" id="cb24-22" data-line-number="22"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb24-23" data-line-number="23"><span class="co">#&gt; Subintensity matrix:</span></a>
<a class="sourceLine" id="cb24-24" data-line-number="24"><span class="co">#&gt;      [,1] [,2]  [,3]</span></a>
<a class="sourceLine" id="cb24-25" data-line-number="25"><span class="co">#&gt; [1,] 0.25 0.25 0.125</span></a>
<a class="sourceLine" id="cb24-26" data-line-number="26"><span class="co">#&gt; [2,] 0.00 0.50 0.000</span></a>
<a class="sourceLine" id="cb24-27" data-line-number="27"><span class="co">#&gt; [3,] 0.00 0.00 0.500</span></a>
<a class="sourceLine" id="cb24-28" data-line-number="28"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb24-29" data-line-number="29"><span class="co">#&gt; Initial probabilities:</span></a>
<a class="sourceLine" id="cb24-30" data-line-number="30"><span class="co">#&gt;      [,1]      [,2]      [,3]</span></a>
<a class="sourceLine" id="cb24-31" data-line-number="31"><span class="co">#&gt; [1,]  0.5 0.1666667 0.3333333</span></a>
<a class="sourceLine" id="cb24-32" data-line-number="32"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb24-33" data-line-number="33"><span class="co">#&gt; Defect:</span></a>
<a class="sourceLine" id="cb24-34" data-line-number="34"><span class="co">#&gt; [1] 0</span></a>
<a class="sourceLine" id="cb24-35" data-line-number="35"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb24-36" data-line-number="36"><span class="co">#&gt; Mean: 2.166667</span></a>
<a class="sourceLine" id="cb24-37" data-line-number="37"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb24-38" data-line-number="38"><span class="co">#&gt; Variance: 2.25</span></a></code></pre></div>
</div>
<div id="user-defined-sub-intensity-matrix-1" class="section level2">
<h2 class="hasAnchor">
<a href="#user-defined-sub-intensity-matrix-1" class="anchor"></a>User-defined sub-intensity matrix</h2>
<p>As with the class <code>cont_phase_type</code>, using the <code><a href="../reference/disc_phase_type.html">disc_phase_type()</a></code> generator the user can specify the sub-intensity matrix, with optional initial probabilities (see <code><a href="../reference/disc_phase_type.html">?disc_phase_type</a></code> for further information).</p>
</div>
<div id="density-distribution-and-quantile-functions-1" class="section level2">
<h2 class="hasAnchor">
<a href="#density-distribution-and-quantile-functions-1" class="anchor"></a>Density, distribution and quantile functions</h2>
<p><code>ticphasetype</code> also contains the density function (<code><a href="../reference/dphtype.html">dphtype()</a></code>), quantile function (<code><a href="../reference/dphtype.html">qphtype()</a></code>), distribution function (<code><a href="../reference/dphtype.html">pphtype()</a></code>) and random draw generator (<code><a href="../reference/dphtype.html">rphtype()</a></code>) for the discrete phase-type distribution. For example, for <span class="math inline">\(S_{total}\)</span> when <span class="math inline">\(\theta=3\)</span>:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1">S_tot_ph &lt;-<span class="st"> </span><span class="kw"><a href="../reference/segsites.html">segsites</a></span>(<span class="dv">10</span>, <span class="dt">theta =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb25-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(S_tot_ph)</a>
<a class="sourceLine" id="cb25-3" data-line-number="3"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb25-4" data-line-number="4"><span class="co">#&gt; Subintensity matrix:</span></a>
<a class="sourceLine" id="cb25-5" data-line-number="5"><span class="co">#&gt;       [,1]      [,2]      [,3]      [,4]       [,5]       [,6]       [,7]</span></a>
<a class="sourceLine" id="cb25-6" data-line-number="6"><span class="co">#&gt;  [1,] 0.25 0.2045455 0.1636364 0.1272727 0.09545455 0.06818182 0.04545455</span></a>
<a class="sourceLine" id="cb25-7" data-line-number="7"><span class="co">#&gt;  [2,] 0.00 0.2727273 0.2181818 0.1696970 0.12727273 0.09090909 0.06060606</span></a>
<a class="sourceLine" id="cb25-8" data-line-number="8"><span class="co">#&gt;  [3,] 0.00 0.0000000 0.3000000 0.2333333 0.17500000 0.12500000 0.08333333</span></a>
<a class="sourceLine" id="cb25-9" data-line-number="9"><span class="co">#&gt;  [4,] 0.00 0.0000000 0.0000000 0.3333333 0.25000000 0.17857143 0.11904762</span></a>
<a class="sourceLine" id="cb25-10" data-line-number="10"><span class="co">#&gt;  [5,] 0.00 0.0000000 0.0000000 0.0000000 0.37500000 0.26785714 0.17857143</span></a>
<a class="sourceLine" id="cb25-11" data-line-number="11"><span class="co">#&gt;  [6,] 0.00 0.0000000 0.0000000 0.0000000 0.00000000 0.42857143 0.28571429</span></a>
<a class="sourceLine" id="cb25-12" data-line-number="12"><span class="co">#&gt;  [7,] 0.00 0.0000000 0.0000000 0.0000000 0.00000000 0.00000000 0.50000000</span></a>
<a class="sourceLine" id="cb25-13" data-line-number="13"><span class="co">#&gt;  [8,] 0.00 0.0000000 0.0000000 0.0000000 0.00000000 0.00000000 0.00000000</span></a>
<a class="sourceLine" id="cb25-14" data-line-number="14"><span class="co">#&gt;  [9,] 0.00 0.0000000 0.0000000 0.0000000 0.00000000 0.00000000 0.00000000</span></a>
<a class="sourceLine" id="cb25-15" data-line-number="15"><span class="co">#&gt;             [,8]       [,9]</span></a>
<a class="sourceLine" id="cb25-16" data-line-number="16"><span class="co">#&gt;  [1,] 0.02727273 0.01363636</span></a>
<a class="sourceLine" id="cb25-17" data-line-number="17"><span class="co">#&gt;  [2,] 0.03636364 0.01818182</span></a>
<a class="sourceLine" id="cb25-18" data-line-number="18"><span class="co">#&gt;  [3,] 0.05000000 0.02500000</span></a>
<a class="sourceLine" id="cb25-19" data-line-number="19"><span class="co">#&gt;  [4,] 0.07142857 0.03571429</span></a>
<a class="sourceLine" id="cb25-20" data-line-number="20"><span class="co">#&gt;  [5,] 0.10714286 0.05357143</span></a>
<a class="sourceLine" id="cb25-21" data-line-number="21"><span class="co">#&gt;  [6,] 0.17142857 0.08571429</span></a>
<a class="sourceLine" id="cb25-22" data-line-number="22"><span class="co">#&gt;  [7,] 0.30000000 0.15000000</span></a>
<a class="sourceLine" id="cb25-23" data-line-number="23"><span class="co">#&gt;  [8,] 0.60000000 0.30000000</span></a>
<a class="sourceLine" id="cb25-24" data-line-number="24"><span class="co">#&gt;  [9,] 0.00000000 0.75000000</span></a>
<a class="sourceLine" id="cb25-25" data-line-number="25"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb25-26" data-line-number="26"><span class="co">#&gt; Initial probabilities:</span></a>
<a class="sourceLine" id="cb25-27" data-line-number="27"><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9]</span></a>
<a class="sourceLine" id="cb25-28" data-line-number="28"><span class="co">#&gt; [1,]    1    0    0    0    0    0    0    0    0</span></a>
<a class="sourceLine" id="cb25-29" data-line-number="29"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb25-30" data-line-number="30"><span class="co">#&gt; Defect:</span></a>
<a class="sourceLine" id="cb25-31" data-line-number="31"><span class="co">#&gt; [1] 0</span></a>
<a class="sourceLine" id="cb25-32" data-line-number="32"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb25-33" data-line-number="33"><span class="co">#&gt; Mean: 9.486905</span></a>
<a class="sourceLine" id="cb25-34" data-line-number="34"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb25-35" data-line-number="35"><span class="co">#&gt; Variance: 22.34481</span></a></code></pre></div>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" data-line-number="1"><span class="kw"><a href="../reference/dphtype.html">dphtype</a></span>(<span class="dv">3</span>, S_tot_ph)</a>
<a class="sourceLine" id="cb26-2" data-line-number="2"><span class="co">#&gt; [1] 0.03715474</span></a></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" data-line-number="1">x &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">30</span></a>
<a class="sourceLine" id="cb27-2" data-line-number="2">y &lt;-<span class="st"> </span><span class="kw"><a href="../reference/dphtype.html">dphtype</a></span>(x, S_tot_ph)</a>
<a class="sourceLine" id="cb27-3" data-line-number="3"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(x, y)</a>
<a class="sourceLine" id="cb27-4" data-line-number="4"><span class="kw"><a href="https://rdrr.io/r/graphics/title.html">title</a></span>(<span class="st">'Density function of S_total with theta=3 and n=10'</span>)</a></code></pre></div>
<p><img src="ticphasetype_files/figure-html/unnamed-chunk-27-1.png" width="700"></p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" data-line-number="1"><span class="kw"><a href="../reference/dphtype.html">pphtype</a></span>(<span class="dv">15</span>, S_tot_ph)</a>
<a class="sourceLine" id="cb28-2" data-line-number="2"><span class="co">#&gt; [1] 0.8944268</span></a></code></pre></div>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" data-line-number="1">x &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">30</span></a>
<a class="sourceLine" id="cb29-2" data-line-number="2">y &lt;-<span class="st"> </span><span class="kw"><a href="../reference/dphtype.html">pphtype</a></span>(x, S_tot_ph)</a>
<a class="sourceLine" id="cb29-3" data-line-number="3"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(x, y)</a>
<a class="sourceLine" id="cb29-4" data-line-number="4"><span class="kw"><a href="https://rdrr.io/r/graphics/title.html">title</a></span>(<span class="st">'Distribution function of S_total with theta=3 and n=10'</span>)</a></code></pre></div>
<p><img src="ticphasetype_files/figure-html/unnamed-chunk-29-1.png" width="700"></p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" data-line-number="1"><span class="kw"><a href="../reference/dphtype.html">qphtype</a></span>(<span class="fl">0.5</span>, S_tot_ph)</a>
<a class="sourceLine" id="cb30-2" data-line-number="2"><span class="co">#&gt; [1] 9</span></a></code></pre></div>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" data-line-number="1">x &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">0</span>,<span class="fl">0.99</span>,<span class="fl">0.01</span>)</a>
<a class="sourceLine" id="cb31-2" data-line-number="2">y &lt;-<span class="st"> </span><span class="kw"><a href="../reference/dphtype.html">qphtype</a></span>(x, S_tot_ph)</a>
<a class="sourceLine" id="cb31-3" data-line-number="3"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(x, y, <span class="dt">type =</span> <span class="st">'l'</span>)</a>
<a class="sourceLine" id="cb31-4" data-line-number="4"><span class="kw"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span>(x, y)</a>
<a class="sourceLine" id="cb31-5" data-line-number="5"><span class="kw"><a href="https://rdrr.io/r/graphics/title.html">title</a></span>(<span class="st">'Quantile function of S_total with theta=3 and n=10'</span>)</a></code></pre></div>
<p><img src="ticphasetype_files/figure-html/unnamed-chunk-31-1.png" width="700"></p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" data-line-number="1"><span class="kw"><a href="../reference/dphtype.html">rphtype</a></span>(<span class="dv">3</span>, S_tot_ph)</a>
<a class="sourceLine" id="cb32-2" data-line-number="2"><span class="co">#&gt; [1] 10 23 10</span></a></code></pre></div>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" data-line-number="1">x &lt;-<span class="st"> </span><span class="kw"><a href="../reference/dphtype.html">rphtype</a></span>(<span class="dv">10000</span>, S_tot_ph)</a>
<a class="sourceLine" id="cb33-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span>(x, <span class="dt">main =</span> <span class="st">'Random draws of S_total with theta=3 and n=10'</span>, <span class="dt">breaks=</span><span class="dv">20</span>)</a></code></pre></div>
<p><img src="ticphasetype_files/figure-html/unnamed-chunk-33-1.png" width="700"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction-to-the-package">Introduction to the package</a></li>
      <li>
<a href="#continuous-phase-type-distributions-t_mrca-and-t_total">Continuous phase-type distributions: <span class="math inline">\(T_{MRCA}\)</span> and <span class="math inline">\(T_{Total}\)</span></a><ul class="nav nav-pills nav-stacked">
<li><a href="#theoretical-background">Theoretical background</a></li>
      <li><a href="#time-until-the-most-recent-common-ancestor-t_mrca">Time until the most recent common ancestor (<span class="math inline">\(T_{MRCA}\)</span>)</a></li>
      <li><a href="#total-tree-lenght-t_total">Total tree lenght (<span class="math inline">\(T_{Total}\)</span>)</a></li>
      <li><a href="#user-defined-sub-intensity-matrix">User-defined sub-intensity matrix</a></li>
      <li><a href="#density-distribution-and-quantile-functions">Density, distribution and quantile functions</a></li>
      </ul>
</li>
      <li>
<a href="#discrete-phase-type-distributions-s_total-xi_i-and-xi_k">Discrete Phase-Type Distributions: <span class="math inline">\(S_{total}\)</span>, <span class="math inline">\(\xi_i\)</span> and <span class="math inline">\(\xi_{k+}\)</span></a><ul class="nav nav-pills nav-stacked">
<li><a href="#theoretical-background-1">Theoretical background</a></li>
      <li><a href="#total-number-of-segregating-sites-s_total">Total number of segregating sites (<span class="math inline">\(S_{total}\)</span>)</a></li>
      <li><a href="#i-tons-xi_i">i-tons (<span class="math inline">\(\xi_i\)</span>)</a></li>
      <li><a href="#tail-statistic-xi_k">Tail-statistic (<span class="math inline">\(\xi_{k+}\)</span>)</a></li>
      <li><a href="#user-defined-sub-intensity-matrix-1">User-defined sub-intensity matrix</a></li>
      <li><a href="#density-distribution-and-quantile-functions-1">Density, distribution and quantile functions</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Iker Rivas-Gonzalez, Tomas Sladecek, Carl Kobel.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
